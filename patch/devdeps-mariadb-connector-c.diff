diff -urN a/zlib/zutil.h b/zlib/zutil.h
--- a/zlib/zutil.h	2021-02-12 02:28:56
+++ b/zlib/zutil.h	2025-12-05 14:32:45
@@ -131,14 +131,15 @@
 #endif
 
 #if defined(MACOS) || defined(TARGET_OS_MAC)
-#  define OS_CODE  7
+#  ifndef OS_CODE
+#    define OS_CODE  7
+#  endif
 #  ifndef Z_SOLO
 #    if defined(__MWERKS__) && __dest_os != __be_os && __dest_os != __win32_os
 #      include <unix.h> /* for fdopen */
 #    else
-#      ifndef fdopen
-#        define fdopen(fd,mode) NULL /* No fdopen() */
-#      endif
+#      // On macOS, fdopen() is available in stdio.h, don't redefine it
+#      // Only define it if it's not already available
 #    endif
 #  endif
 #endif
@@ -160,7 +161,16 @@
 #endif
 
 #ifdef __APPLE__
-#  define OS_CODE 19
+#  ifndef OS_CODE
+#    define OS_CODE 19
+#  endif
+#  ifndef Z_SOLO
+#    // On macOS, fdopen() is available in stdio.h, don't redefine it
+#    // Undefine any previous fdopen macro definition to avoid conflicts
+#    ifdef fdopen
+#      undef fdopen
+#    endif
+#  endif
 #endif
 
 #if defined(_BEOS_) || defined(RISCOS)
